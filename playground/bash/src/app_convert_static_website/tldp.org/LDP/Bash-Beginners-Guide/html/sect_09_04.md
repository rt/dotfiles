::: {.NAVHEADER}
Bash Guide for Beginners
:::

[Prev](sect_09_03.md)

Chapter 9. Repetitive tasks

[Next](sect_09_05.md)

------------------------------------------------------------------------

::: {.sect1}
[]{#sect_09_04}9.4. I/O redirection and loops {#io-redirection-and-loops .sect1}
=============================================

::: {.sect2}
[]{#sect_09_04_01}9.4.1. Input redirection {#input-redirection .sect2}
------------------------------------------

Instead of controlling a loop by testing the result of a command or by
user input, you can specify a file from which to read input that
controls the loop. In such cases, **read** is often the controlling
command. As long as input lines are fed into the loop, execution of the
loop commands continues. As soon as all the input lines are read the
loop exits.

Since the loop construct is considered to be one command structure (such
as **while TEST-COMMAND; do CONSEQUENT-COMMANDS; done**), the
redirection should occur after the **done** statement, so that it
complies with the form

**command \< `file`{.filename}**

This kind of redirection also works with other kinds of loops.
:::

::: {.sect2}
[]{#sect_09_04_02}9.4.2. Output redirection {#output-redirection .sect2}
-------------------------------------------

In the example below, output of the **find** command is used as input
for the **read** command controlling a **while** loop:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [carol@octarine ~/testdir] cat archiveoldstuff.sh                    |
| #!/bin/bash                                                           |
|                                                                       |
| # This script creates a subdirectory in the current directory, to whi |
| ch old                                                                |
| # files are moved.                                                    |
| # Might be something for cron (if slightly adapted) to execute weekly |
|  or                                                                   |
| # monthly.                                                            |
|                                                                       |
| ARCHIVENR=`date +%Y%m%d`                                              |
| DESTDIR="$PWD/archive-$ARCHIVENR"                                     |
|                                                                       |
| mkdir "$DESTDIR"                                                      |
|                                                                       |
| # using quotes to catch file names containing spaces, using read -d f |
| or more                                                               |
| # fool-proof usage:                                                   |
| find "$PWD" -type f -a -mtime +5 | while read -d $'\000' file         |
|                                                                       |
| do                                                                    |
| gzip "$file"; mv "$file".gz "$DESTDIR"                                |
| echo "$file archived"                                                 |
| done                                                                  |
| ```                                                                   |
+-----------------------------------------------------------------------+

Files are compressed before they are moved into the archive directory.
:::
:::

::: {.NAVFOOTER}

------------------------------------------------------------------------

  ------------------------- -------------------- -------------------------
  [Prev](sect_09_03.md)    [Home](index.md)    [Next](sect_09_05.md)
  The until loop             [Up](chap_09.md)         Break and continue
  ------------------------- -------------------- -------------------------
:::
