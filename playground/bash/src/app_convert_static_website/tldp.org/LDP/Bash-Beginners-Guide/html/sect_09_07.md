::: {.NAVHEADER}
Bash Guide for Beginners
:::

[Prev](sect_09_06.md)

Chapter 9. Repetitive tasks

[Next](sect_09_08.md)

------------------------------------------------------------------------

::: {.sect1}
[]{#sect_09_07}9.7. The shift built-in {#the-shift-built-in .sect1}
======================================

::: {.sect2}
[]{#sect_09_07_01}9.7.1. What does it do? {#what-does-it-do .sect2}
-----------------------------------------

The **shift** command is one of the Bourne shell built-ins that comes
with Bash. This command takes one argument, a number. The positional
parameters are shifted to the left by this number, *N*. The positional
parameters from `N+1`{.varname} to `$#`{.varname} are renamed to
variable names from `$1`{.varname} to `$# - N+1`{.varname}.

Say you have a command that takes 10 arguments, and N is 4, then
`$4`{.varname} becomes `$1`{.varname}, `$5`{.varname} becomes
`$2`{.varname} and so on. `$10`{.varname} becomes `$7`{.varname} and the
original `$1`{.varname}, `$2`{.varname} and `$3`{.varname} are thrown
away.

If N is zero or greater than `$#`{.varname}, the positional parameters
are not changed (the total number of arguments, see [Section
7.2.1.2](sect_07_02.md#sect_07_02_01_02)) and the command has no
effect. If N is not present, it is assumed to be 1. The return status is
zero unless N is greater than `$#`{.varname} or less than zero;
otherwise it is non-zero.
:::

::: {.sect2}
[]{#sect_09_07_02}9.7.2. Examples {#examples .sect2}
---------------------------------

A shift statement is typically used when the number of arguments to a
command is not known in advance, for instance when users can give as
many arguments as they like. In such cases, the arguments are usually
processed in a **while** loop with a test condition of **(( \$\# ))**.
This condition is true as long as the number of arguments is greater
than zero. The `$1`{.varname} variable and the **shift** statement
process each argument. The number of arguments is reduced each time
**shift** is executed and eventually becomes zero, upon which the
**while** loop exits.

The example below, `cleanup.sh`{.filename}, uses **shift** statements to
process each file in the list generated by **find**:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| #!/bin/bash                                                          |
|                                                                       |
| # This script can clean up files that were last accessed over 365 day |
| s ago.                                                                |
|                                                                       |
| USAGE="Usage: $0 dir1 dir2 dir3 ... dirN"                             |
|                                                                       |
| if [ "$#" == "0" ]; then                                              |
|     echo "$USAGE"                                                     |
|     exit 1                                                            |
| fi                                                                    |
|                                                                       |
| while (( "$#" )); do                                                  |
|                                                                       |
| if [[ $(ls "$1") == "" ]]; then                                       |
|     echo "Empty directory, nothing to be done."                       |
|   else                                                                |
|     find "$1" -type f -a -atime +365 -exec rm -i {} \;                |
| fi                                                                    |
|                                                                       |
| shift                                                                 |
|                                                                       |
| done                                                                  |
| ```                                                                   |
+-----------------------------------------------------------------------+

::: {.note}
+-----------------------------------+-----------------------------------+
| ![Note](http://tldp.org/LDP/Bash- | **-exec vs. xargs**               |
| Beginners-Guide/images/note.gif)  |                                   |
+-----------------------------------+-----------------------------------+
| Â                                  | The above **find** command can be |
|                                   | replaced with the following:      |
|                                   |                                   |
|                                   | **find `options`{.option} \|      |
|                                   | xargs                             |
|                                   | \[commands\_to\_execute\_on\_foun |
|                                   | d\_files\]**                      |
|                                   |                                   |
|                                   | The **xargs** command builds and  |
|                                   | executes command lines from       |
|                                   | standard input. This has the      |
|                                   | advantage that the command line   |
|                                   | is filled until the system limit  |
|                                   | is reached. Only then will the    |
|                                   | command to execute be called, in  |
|                                   | the above example this would be   |
|                                   | **rm**. If there are more         |
|                                   | arguments, a new command line     |
|                                   | will be used, until that one is   |
|                                   | full or until there are no more   |
|                                   | arguments. The same thing using   |
|                                   | **find `-exec`{.option}** calls   |
|                                   | on the command to execute on the  |
|                                   | found files every time a file is  |
|                                   | found. Thus, using **xargs**      |
|                                   | greatly speeds up your scripts    |
|                                   | and the performance of your       |
|                                   | machine.                          |
+-----------------------------------+-----------------------------------+
:::

In the next example, we modified the script from [Section
8.2.4.4](sect_08_02.md#sect_08_02_04_04) so that it accepts multiple
packages to install at once:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| #!/bin/bash                                                          |
| if [ $# -lt 1 ]; then                                                 |
|         echo "Usage: $0 package(s)"                                   |
|         exit 1                                                        |
| fi                                                                    |
| while (($#)); do                                                      |
|     yum install "$1" << CONFIRM                                       |
| y                                                                     |
| CONFIRM                                                               |
| shift                                                                 |
| done                                                                  |
| ```                                                                   |
+-----------------------------------------------------------------------+
:::
:::

::: {.NAVFOOTER}

------------------------------------------------------------------------

  --------------------------------------- -------------------- -------------------------
  [Prev](sect_09_06.md)                  [Home](index.md)    [Next](sect_09_08.md)
  Making menus with the select built-in    [Up](chap_09.md)                    Summary
  --------------------------------------- -------------------- -------------------------
:::
