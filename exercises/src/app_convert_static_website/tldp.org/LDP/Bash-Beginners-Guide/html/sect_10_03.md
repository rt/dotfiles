::: {.NAVHEADER}
Bash Guide for Beginners
:::

[Prev](sect_10_02.md)

Chapter 10. More on variables

[Next](sect_10_04.md)

------------------------------------------------------------------------

::: {.sect1}
[]{#sect_10_03}10.3. Operations on variables {#operations-on-variables .sect1}
============================================

::: {.sect2}
[]{#sect_10_03_01}10.3.1. Arithmetic on variables {#arithmetic-on-variables .sect2}
-------------------------------------------------

We discussed this already in [Section
3.4.6](sect_03_04.md#sect_03_04_05).
:::

::: {.sect2}
[]{#sect_10_03_02}10.3.2. Length of a variable {#length-of-a-variable .sect2}
----------------------------------------------

Using the **\${\#`VAR`{.varname}}** syntax will calculate the number of
characters in a variable. If `VAR`{.varname} is [\"\*\"]{.QUOTE} or
[\"@\"]{.QUOTE}, this value is substituted with the number of positional
parameters or number of elements in an array in general. This is
demonstrated in the example below:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [bob in ~] echo $SHELL                                               |
| /bin/bash                                                             |
|                                                                       |
| [bob in ~] echo ${#SHELL}                                             |
| 9                                                                     |
|                                                                       |
| [bob in ~] ARRAY=(one two three)                                      |
|                                                                       |
| [bob in ~] echo ${#ARRAY}                                             |
| 3                                                                     |
| ```                                                                   |
+-----------------------------------------------------------------------+
:::

::: {.sect2}
[]{#sect_10_03_03}10.3.3. Transformations of variables {#transformations-of-variables .sect2}
------------------------------------------------------

::: {.sect3}
### []{#sect_10_03_03_01}10.3.3.1. Substitution {#substitution .sect3}

**\${`VAR`{.varname}:-`WORD`{.parameter}}**

If `VAR`{.varname} is not defined or null, the expansion of
`WORD`{.parameter} is substituted; otherwise the value of
`VAR`{.varname} is substituted:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [bob in ~] echo ${TEST:-test}                                        |
| test                                                                  |
|                                                                       |
| [bob in ~] echo $TEST                                                 |
|                                                                       |
|                                                                       |
| [bob in ~] export TEST=a_string                                       |
|                                                                       |
| [bob in ~] echo ${TEST:-test}                                         |
| a_string                                                              |
|                                                                       |
| [bob in ~] echo ${TEST2:-$TEST}                                       |
| a_string                                                              |
| ```                                                                   |
+-----------------------------------------------------------------------+

This form is often used in conditional tests, for instance in this one:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [ -z "${COLUMNS:-}" ] && COLUMNS=80                                  |
| ```                                                                   |
+-----------------------------------------------------------------------+

It is a shorter notation for

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| if [ -z "${COLUMNS:-}" ]; then                                       |
|     COLUMNS=80                                                        |
| fi                                                                    |
| ```                                                                   |
+-----------------------------------------------------------------------+

See [Section 7.1.2.3](sect_07_01.md#sect_07_01_02_03) for more
information about this type of condition testing.

If the hyphen (-) is replaced with the equal sign (=), the value is
assigned to the parameter if it does not exist:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [bob in ~] echo $TEST2                                               |
|                                                                       |
|                                                                       |
| [bob in ~] echo ${TEST2:=$TEST}                                       |
| a_string                                                              |
|                                                                       |
| [bob in ~] echo $TEST2                                                |
| a_string                                                              |
| ```                                                                   |
+-----------------------------------------------------------------------+

The following syntax tests the existence of a variable. If it is not
set, the expansion of `WORD`{.parameter} is printed to standard out and
non-interactive shells quit. A demonstration:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [bob in ~] cat vartest.sh                                            |
| #!/bin/bash                                                           |
|                                                                       |
| # This script tests whether a variable is set.  If not,               |
| # it exits printing a message.                                        |
|                                                                       |
| echo ${TESTVAR:?"There's so much I still wanted to do..."}            |
| echo "TESTVAR is set, we can proceed."                                |
|                                                                       |
| [bob in testdir] ./vartest.sh                                         |
| ./vartest.sh: line 6: TESTVAR: There's so much I still wanted to do.. |
| .                                                                     |
|                                                                       |
| [bob in testdir] export TESTVAR=present                               |
|                                                                       |
| [bob in testdir] ./vartest.sh                                         |
| present                                                               |
| TESTVAR is set, we can proceed.                                       |
| ```                                                                   |
+-----------------------------------------------------------------------+

Using [\"+\"]{.QUOTE} instead of the exclamation mark sets the variable
to the expansion of `WORD`{.parameter}; if it does not exist, nothing
happens.
:::

::: {.sect3}
### []{#sect_10_03_03_02}10.3.3.2. Removing substrings {#removing-substrings .sect3}

To strip a number of characters, equal to `OFFSET`{.parameter}, from a
variable, use this syntax:

**\${`VAR`{.varname}:`OFFSET`{.parameter}:`LENGTH`{.parameter}}**

The `LENGTH`{.parameter} parameter defines how many characters to keep,
starting from the first character after the offset point. If
`LENGTH`{.parameter} is omitted, the remainder of the variable content
is taken:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [bob in ~] export STRING="thisisaverylongname"                       |
|                                                                       |
| [bob in ~] echo ${STRING:4}                                           |
| isaverylongname                                                       |
|                                                                       |
| [bob in ~] echo ${STRING:6:5}                                         |
| avery                                                                 |
| ```                                                                   |
+-----------------------------------------------------------------------+

**\${`VAR`{.varname}\#`WORD`{.parameter}}**

and

**\${`VAR`{.varname}\#\#`WORD`{.parameter}}**

These constructs are used for deleting the pattern matching the
expansion of `WORD`{.parameter} in `VAR`{.varname}. `WORD`{.parameter}
is expanded to produce a pattern just as in file name expansion. If the
pattern matches the beginning of the expanded value of `VAR`{.varname},
then the result of the expansion is the expanded value of
`VAR`{.varname} with the shortest matching pattern ([\"\#\"]{.QUOTE}) or
the longest matching pattern (indicated with [\"\#\#\"]{.QUOTE}).

If `VAR`{.varname} is `*`{.varname} or `@`{.varname}, the pattern
removal operation is applied to each positional parameter in turn, and
the expansion is the resultant list.

If `VAR`{.varname} is an array variable subscribed with [\"\*\"]{.QUOTE}
or [\"@\"]{.QUOTE}, the pattern removal operation is applied to each
member of the array in turn, and the expansion is the resultant list.
This is shown in the examples below:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [bob in ~] echo ${ARRAY[*]}                                          |
| one two one three one four                                            |
|                                                                       |
| [bob in ~] echo ${ARRAY[*]#one}                                       |
| two three four                                                        |
|                                                                       |
| [bob in ~] echo ${ARRAY[*]#t}                                         |
| one wo one hree one four                                              |
|                                                                       |
| [bob in ~] echo ${ARRAY[*]#t*}                                        |
| one wo one hree one four                                              |
|                                                                       |
| [bob in ~] echo ${ARRAY[*]##t*}                                       |
| one one one four                                                      |
| ```                                                                   |
+-----------------------------------------------------------------------+

The opposite effect is obtained using [\"%\"]{.QUOTE} and
[\"%%\"]{.QUOTE}, as in this example below. `WORD`{.parameter} should
match a trailing portion of string:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [bob in ~] echo $STRING                                              |
| thisisaverylongname                                                   |
|                                                                       |
| [bob in ~] echo ${STRING%name}                                        |
| thisisaverylong                                                       |
| ```                                                                   |
+-----------------------------------------------------------------------+
:::

::: {.sect3}
### []{#sect_10_03_03_03}10.3.3.3. Replacing parts of variable names {#replacing-parts-of-variable-names .sect3}

This is done using the

**\${`VAR`{.varname}/`PATTERN`{.parameter}/`STRING`{.parameter}}**

or

**\${`VAR`{.varname}//`PATTERN`{.parameter}/`STRING`{.parameter}}**

syntax. The first form replaces only the first match, the second
replaces all matches of `PATTERN`{.parameter} with `STRING`{.parameter}:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [bob in ~] echo ${STRING/name/string}                                |
| thisisaverylongstring                                                 |
| ```                                                                   |
+-----------------------------------------------------------------------+

More information can be found in the Bash info pages.
:::
:::
:::

::: {.NAVFOOTER}

------------------------------------------------------------------------

  ------------------------- -------------------- -------------------------
  [Prev](sect_10_02.md)    [Home](index.md)    [Next](sect_10_04.md)
  Array variables            [Up](chap_10.md)                    Summary
  ------------------------- -------------------- -------------------------
:::
