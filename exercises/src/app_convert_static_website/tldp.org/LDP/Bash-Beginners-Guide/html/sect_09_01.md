::: {.NAVHEADER}
Bash Guide for Beginners
:::

[Prev](chap_09.md)

Chapter 9. Repetitive tasks

[Next](sect_09_02.md)

------------------------------------------------------------------------

::: {.sect1}
[]{#sect_09_01}9.1. The for loop {#the-for-loop .sect1}
================================

::: {.sect2}
[]{#sect_09_01_01}9.1.1. How does it work? {#how-does-it-work .sect2}
------------------------------------------

The **for** loop is the first of the three shell looping constructs.
This loop allows for specification of a list of values. A list of
commands is executed for each value in the list.

The syntax for this loop is:

**for `NAME`{.varname} \[in LIST \]; do COMMANDS; done**

If **\[in LIST\]** is not present, it is replaced with **in
`$@`{.varname}** and **for** executes the **COMMANDS** once for each
positional parameter that is set (see [Section
3.2.5](sect_03_02.md#sect_03_02_05) and [Section
7.2.1.2](sect_07_02.md#sect_07_02_01_02)).

The return status is the exit status of the last command that executes.
If no commands are executed because `LIST`{.varname} does not expand to
any items, the return status is zero.

`NAME`{.varname} can be any variable name, although `i`{.varname} is
used very often. `LIST`{.varname} can be any list of words, strings or
numbers, which can be literal or generated by any command. The
**COMMANDS** to execute can also be any operating system commands,
script, program or shell statement. The first time through the loop,
`NAME`{.varname} is set to the first item in `LIST`{.varname}. The
second time, its value is set to the second item in the list, and so on.
The loop terminates when `NAME`{.varname} has taken on each of the
values from `LIST`{.varname} and no items are left in `LIST`{.varname}.
:::

::: {.sect2}
[]{#sect_09_01_02}9.1.2. Examples {#examples .sect2}
---------------------------------

::: {.sect3}
### []{#sect_09_01_02_03}9.1.2.1. Using command substitution for specifying LIST items {#using-command-substitution-for-specifying-list-items .sect3}

The first is a command line example, demonstrating the use of a **for**
loop that makes a backup copy of each `.xml`{.filename} file. After
issuing the command, it is safe to start working on your sources:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [carol@octarine ~/articles] ls *.xml                                 |
| file1.xml  file2.xml  file3.xml                                       |
|                                                                       |
| [carol@octarine ~/articles] ls *.xml > list                           |
|                                                                       |
| [carol@octarine ~/articles] for i in `cat list`; do cp "$i" "$i".bak  |
| ; done                                                                |
|                                                                       |
| [carol@octarine ~/articles] ls *.xml*                                 |
| file1.xml  file1.xml.bak  file2.xml  file2.xml.bak  file3.xml  file3. |
| xml.bak                                                               |
| ```                                                                   |
+-----------------------------------------------------------------------+

This one lists the files in `/sbin`{.filename} that are just plain text
files, and possibly scripts:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| for i in `ls /sbin`; do file /sbin/$i | grep ASCII; done             |
| ```                                                                   |
+-----------------------------------------------------------------------+
:::

::: {.sect3}
### []{#sect_09_01_02_02}9.1.2.2. Using the content of a variable to specify LIST items {#using-the-content-of-a-variable-to-specify-list-items .sect3}

The following is a specific application script for converting HTML
files, compliant with a certain scheme, to PHP files. The conversion is
done by taking out the first 25 and the last 21 lines, replacing these
with two PHP tags that provide header and footer lines:

+-----------------------------------------------------------------------+
| ``` {.screen}                                                         |
| [carol@octarine ~/html] cat html2php.sh                              |
| #!/bin/bash                                                           |
| # specific conversion script for my html files to php                 |
| LIST="$(ls *.md)"                                                   |
| for i in "$LIST"; do                                                  |
|      NEWNAME=$(ls "$i" | sed -e 's/html/php/')                        |
|      cat beginfile > "$NEWNAME"                                       |
|      cat "$i" | sed -e '1,25d' | tac | sed -e '1,21d'| tac >> "$NEWNA |
| ME"                                                                   |
|      cat endfile >> "$NEWNAME"                                        |
| done                                                                  |
| ```                                                                   |
+-----------------------------------------------------------------------+

Since we don\'t do a line count here, there is no way of knowing the
line number from which to start deleting lines until reaching the end.
The problem is solved using **tac**, which reverses the lines in a file.

::: {.tip}
+-----------------------------------+-----------------------------------+
| ![Tip](http://tldp.org/LDP/Bash-B | **The basename command**          |
| eginners-Guide/images/tip.gif)    |                                   |
+-----------------------------------+-----------------------------------+
|                                   | Instead of using **sed** to       |
|                                   | replace the `html`{.filename}     |
|                                   | suffix with `php`{.filename}, it  |
|                                   | would be cleaner to use the       |
|                                   | **basename** command. Read the    |
|                                   | man page for more info.           |
+-----------------------------------+-----------------------------------+
:::

::: {.warning}
+-----------------------------------+-----------------------------------+
| ![Warning](http://tldp.org/LDP/Ba | **Odd characters**                |
| sh-Beginners-Guide/images/warning |                                   |
| .gif)                             |                                   |
+-----------------------------------+-----------------------------------+
|                                   | You will run into problems if the |
|                                   | list expands to file names        |
|                                   | containing spaces and other       |
|                                   | irregular characters. A more      |
|                                   | ideal construct to obtain the     |
|                                   | list would be to use the shell\'s |
|                                   | globbing feature, like this:      |
|                                   |                                   |
|                                   | +------------------------------+  |
|                                   | | ``` {.screen}                |  |
|                                   | | for i in $PATHNAME/*; do    |  |
|                                   | |     commands                 |  |
|                                   | | done                         |  |
|                                   | | ```                          |  |
|                                   | +------------------------------+  |
+-----------------------------------+-----------------------------------+
:::
:::
:::
:::

::: {.NAVFOOTER}

------------------------------------------------------------------------

  ---------------------- -------------------- -------------------------
  [Prev](chap_09.md)    [Home](index.md)    [Next](sect_09_02.md)
  Repetitive tasks        [Up](chap_09.md)             The while loop
  ---------------------- -------------------- -------------------------
:::
